---
import { getToolStaticPaths } from '@inbrowserapp/tools-registry'
import { translateMeta, supportedLanguages } from '@inbrowserapp/tools-i18n'
import type { SupportedLanguage, ToolRouteProps, ToolComponent } from '@inbrowserapp/tools-shared'
import ToolLayout from '../../../layouts/ToolLayout.astro'

export async function getStaticPaths() {
  const paths = await getToolStaticPaths()
  // Exclude English (English uses default route)
  const languages = supportedLanguages.filter((lang) => lang !== 'en')

  return paths.flatMap((p) =>
    languages.map((lang) => ({
      params: { lang, path: p.params.path },
      props: { ...p.props, lang },
    }))
  )
}

type Props = ToolRouteProps & { lang: SupportedLanguage }
const { metadata, component: loadComponent, lang } = Astro.props as Props
const meta = translateMeta(metadata, lang)
const Component = (await loadComponent()).default as ToolComponent
---

<ToolLayout title={meta.ui.name} description={meta.ui.description} lang={lang}>
  <Component ui={meta.ui} lang={lang} />
</ToolLayout>
