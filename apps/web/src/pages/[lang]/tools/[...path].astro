---
import { getToolStaticPaths } from '@registry/tools'
import { translateMeta, supportedLanguages } from '@shared/tools'
import type { SupportedLanguage, ToolComponent } from '@shared/tools'
import BaseLayout from '../../../layouts/BaseLayout.astro'

export async function getStaticPaths() {
  const paths = await getToolStaticPaths()
  // Exclude English (English uses default route)
  const languages: SupportedLanguage[] = supportedLanguages.filter((lang) => lang !== 'en')

  return paths.flatMap((p) =>
    languages.map((lang) => ({
      params: { lang, path: p.params.path },
      props: { ...p.props, lang },
    }))
  )
}

const { metadata, component: loadComponent, lang } = Astro.props
const i18n = translateMeta(metadata, lang)
const Component = (await loadComponent()).default as ToolComponent
---

<BaseLayout title={i18n.name} description={i18n.description} lang={lang}>
  <Component i18n={i18n} lang={lang} />
</BaseLayout>
